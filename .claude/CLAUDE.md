# CLAUDE.md

## 0. Global Protocols

æ‰€æœ‰æ“ä½œå¿…é¡»ä¸¥æ ¼éµå¾ªä»¥ä¸‹ç³»ç»Ÿçº¦æŸï¼š

- **äº¤äº’è¯­è¨€**ï¼šä¸å·¥å…·æˆ–æ¨¡å‹äº¤äº’å¼ºåˆ¶ä½¿ç”¨ **English**ï¼›ç”¨æˆ·è¾“å‡ºå¼ºåˆ¶ä½¿ç”¨ **ä¸­æ–‡**ã€‚
- **å¤šè½®å¯¹è¯**ï¼šå¦‚æœå·¥å…·æˆ–æ¨¡å‹è¿”å›çš„æœ‰å¯æŒç»­å¯¹è¯å­—æ®µ ï¼Œæ¯”å¦‚ `SESSION_ID`ï¼Œè¡¨æ˜å·¥å…·æ”¯æŒå¤šè½®å¯¹è¯ï¼Œæ­¤æ—¶è®°å½•è¯¥å­—æ®µï¼Œå¹¶åœ¨éšåçš„å·¥å…·è°ƒç”¨ä¸­**å¼ºåˆ¶æ€è€ƒ**ï¼Œæ˜¯å¦ç»§ç»­è¿›è¡Œå¯¹è¯ã€‚ä¾‹å¦‚ï¼Œ Codex/Gemini æœ‰æ—¶ä¼šå› å†…éƒ¨å·¥å…·è°ƒç”¨ä¸­æ–­ä¼šè¯ï¼Œè‹¥æ²¡æœ‰å¾—åˆ°éœ€è¦çš„å›å¤ï¼Œåˆ™åº”ç»§ç»­å¯¹è¯ã€‚
- **æ²™ç®±å®‰å…¨**ï¼šä¸¥ç¦ Codex/Gemini å¯¹æ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå†™æ“ä½œã€‚æ‰€æœ‰ä»£ç è·å–å¿…é¡»åœ¨ PROMPT ä¸­**æ˜ç¡®è¦æ±‚**ï¼Œ è¿”å› `Unified Diff Patch`ï¼Œä¸¥ç¦ Codex/Gemini åšä»»ä½•çœŸå®ä¿®æ”¹ã€‚
- **ä»£ç ä¸»æƒ**ï¼šå¤–éƒ¨æ¨¡å‹ç”Ÿæˆçš„ä»£ç ä»…ä½œä¸ºé€»è¾‘å‚è€ƒï¼ˆPrototypeï¼‰ï¼Œæœ€ç»ˆäº¤ä»˜ä»£ç **å¿…é¡»ç»è¿‡é‡æ„**ï¼Œç¡®ä¿æ— å†—ä½™ã€ä¼ä¸šçº§æ ‡å‡†ã€‚
- **é£æ ¼å®šä¹‰**ï¼šæ•´ä½“ä»£ç é£æ ¼**å§‹ç»ˆå®šä½**ä¸ºï¼Œç²¾ç®€é«˜æ•ˆã€æ¯«æ— å†—ä½™ã€‚è¯¥è¦æ±‚åŒæ ·é€‚ç”¨äºæ³¨é‡Šä¸æ–‡æ¡£ï¼Œä¸”å¯¹äºè¿™ä¸¤è€…ï¼Œä¸¥æ ¼éµå¾ª**éå¿…è¦ä¸å½¢æˆ**çš„æ ¸å¿ƒåŸåˆ™ã€‚
- **ä»…å¯¹éœ€æ±‚åšé’ˆå¯¹æ€§æ”¹åŠ¨**ï¼Œä¸¥ç¦å½±å“ç”¨æˆ·ç°æœ‰çš„å…¶ä»–åŠŸèƒ½ã€‚
- Codex/Gemini äº’åŠ¨æ–¹å¼ä»¥ SKILL å½¢å¼ç»™å‡ºï¼Œ**å¼ºåˆ¶ç§¯ææŸ¥çœ‹ã€è°ƒç”¨**ã€‚ä¸¤è€…å‡éœ€è¦è¾ƒé•¿è°ƒç”¨æ—¶é•¿ï¼ˆç³»ç»Ÿé»˜è®¤"BASH_DEFAULT_TIMEOUT_MS": "300000"ï¼‰ï¼Œè€å¿ƒç­‰å¾…å³å¯ã€‚
- å½“æ£€æµ‹åˆ°å¯å¹¶è¡ŒåŒ–æ‰§è¡Œçš„ä»»åŠ¡æ—¶ï¼Œå°½ä¸€åˆ‡å¯èƒ½ä»¥å¹¶è¡Œæ–¹å¼æ‰§è¡Œã€‚ä¾‹å¦‚å½“æœ‰å¤šä¸ª SKILL ç›¸å…³çš„ bash å‘½ä»¤å­˜åœ¨æ—¶ï¼Œå¯ä½¿ç”¨`run in background`æ–¹å¼**ç«‹å³**å¯¹éœ€è¦é•¿æ—¶é—´è¿è¡Œçš„ç¨‹åºè¿›è¡ŒæŒ‚èµ·ä»¥ä¾¿æ‰§è¡Œä¸‹ä¸€ä¸ªå‘½ä»¤ï¼Œè¾¾åˆ°å¹¶è¡Œç›®çš„ã€‚
- å¼ºåˆ¶éµå¾ª 1. Workflow ä¸­çš„æ‰€æœ‰ Phaseï¼Œä¸¥ç¦é—æ¼ä»»ä½•è¿‡ç¨‹ã€‚

## 1. Workflow

### Phase 1: ä¸Šä¸‹æ–‡å…¨é‡æ£€ç´¢ (Auggie Interface)

**æ‰§è¡Œæ¡ä»¶**ï¼šåœ¨ç”Ÿæˆä»»ä½•å»ºè®®æˆ–ä»£ç å‰ã€‚

1.  **å·¥å…·è°ƒç”¨**ï¼šè°ƒç”¨ `mcp__augment-context-engine-mcp__codebase-retrieval`ã€‚
2.  **æ£€ç´¢ç­–ç•¥**ï¼š
    - ç¦æ­¢åŸºäºå‡è®¾ï¼ˆAssumptionï¼‰å›ç­”ã€‚
    - ä½¿ç”¨è‡ªç„¶è¯­è¨€ï¼ˆNLï¼‰æ„å»ºè¯­ä¹‰æŸ¥è¯¢ï¼ˆWhere/What/Howï¼‰ã€‚
    - **å®Œæ•´æ€§æ£€æŸ¥**ï¼šå¿…é¡»è·å–ç›¸å…³ç±»ã€å‡½æ•°ã€å˜é‡çš„å®Œæ•´å®šä¹‰ä¸ç­¾åã€‚è‹¥ä¸Šä¸‹æ–‡ä¸è¶³ï¼Œè§¦å‘é€’å½’æ£€ç´¢ã€‚
3.  **éœ€æ±‚å¯¹é½**ï¼šè‹¥æ£€ç´¢åéœ€æ±‚ä»æœ‰æ¨¡ç³Šç©ºé—´ï¼Œ**å¿…é¡»**å‘ç”¨æˆ·è¾“å‡ºå¼•å¯¼æ€§é—®é¢˜åˆ—è¡¨ï¼Œç›´è‡³éœ€æ±‚è¾¹ç•Œæ¸…æ™°ï¼ˆæ— é—æ¼ã€æ— å†—ä½™ï¼‰ã€‚

### Phase 2: å¤šæ¨¡å‹åä½œåˆ†æ (Analysis & Strategy)

**æ‰§è¡Œæ¡ä»¶**ï¼šä¸Šä¸‹æ–‡å°±ç»ªåï¼Œç¼–ç å¼€å§‹å‰ã€‚

1.  **åˆ†å‘è¾“å…¥**ï¼šï¼šå°†ç”¨æˆ·çš„**åŸå§‹éœ€æ±‚**ï¼ˆä¸å¸¦é¢„è®¾è§‚ç‚¹ï¼‰åˆ†å‘ç»™ Codex å’Œ Geminiã€‚æ³¨æ„ï¼ŒCodex/Gemini éƒ½æœ‰å®Œå–„çš„ CLI ç³»ç»Ÿï¼Œæ‰€ä»¥**æ— éœ€ç»™å‡ºè¿‡å¤šä¸Šä¸‹æ–‡**ã€‚
2.  **æ–¹æ¡ˆè¿­ä»£**ï¼š
    - è¦æ±‚æ¨¡å‹æä¾›å¤šè§’åº¦è§£å†³æ–¹æ¡ˆã€‚
    - è§¦å‘**äº¤å‰éªŒè¯**ï¼šæ•´åˆå„æ–¹æ€è·¯ï¼Œè¿›è¡Œè¿­ä»£ä¼˜åŒ–ï¼Œåœ¨è¿‡ç¨‹ä¸­æ‰§è¡Œé€»è¾‘æ¨æ¼”å’Œä¼˜åŠ£åŠ¿äº’è¡¥ï¼Œç›´è‡³ç”Ÿæˆæ— é€»è¾‘æ¼æ´çš„ Step-by-step å®æ–½è®¡åˆ’ã€‚
3.  **ç”¨æˆ·ç¡®è®¤**ï¼šå‘ç”¨æˆ·å±•ç¤ºæœ€ç»ˆå®æ–½è®¡åˆ’ï¼ˆå«é€‚åº¦ä¼ªä»£ç ï¼‰ã€‚

### Phase 3: åŸå‹è·å– (Prototyping)

**æ‰§è¡Œæ¡ä»¶**ï¼šå®æ–½è®¡åˆ’ç¡®è®¤åã€‚æ ¹æ®ä»»åŠ¡ç±»å‹è·¯ç”±ï¼š

- **Route A: å‰ç«¯/UI/æ ·å¼ (Gemini Kernel)**
  - **é™åˆ¶**ï¼šä¸Šä¸‹æ–‡ < 32kã€‚gemini å¯¹äºåç«¯é€»è¾‘çš„ç†è§£æœ‰ç¼ºé™·ï¼Œå…¶å›å¤éœ€è¦å®¢è§‚å®¡è§†ã€‚
  - **æŒ‡ä»¤**ï¼šè¯·æ±‚ CSS/React/Vue åŸå‹ã€‚ä»¥æ­¤ä¸ºæœ€ç»ˆå‰ç«¯è®¾è®¡åŸå‹ä¸è§†è§‰åŸºå‡†ã€‚
- **Route B: åç«¯/é€»è¾‘/ç®—æ³• (Codex Kernel)**
  - **èƒ½åŠ›**ï¼šåˆ©ç”¨å…¶é€»è¾‘è¿ç®—ä¸ Debug èƒ½åŠ›ã€‚
  - **æŒ‡ä»¤**ï¼šè¯·æ±‚é€»è¾‘å®ç°åŸå‹ã€‚
- **é€šç”¨çº¦æŸ**ï¼šï¼šåœ¨ä¸ Codex/Gemini æ²Ÿé€šçš„ä»»ä½•æƒ…å†µä¸‹ï¼Œ**å¿…é¡»**åœ¨ Prompt ä¸­**æ˜ç¡®è¦æ±‚** è¿”å› `Unified Diff Patch`ï¼Œä¸¥ç¦ Codex/Gemini åšä»»ä½•çœŸå®ä¿®æ”¹ã€‚

### Phase 4: ç¼–ç å®æ–½ (Implementation)

**æ‰§è¡Œå‡†åˆ™**ï¼š

1.  **é€»è¾‘é‡æ„**ï¼šåŸºäº Phase 3 çš„åŸå‹ï¼Œå»é™¤å†—ä½™ï¼Œ**é‡å†™**ä¸ºé«˜å¯è¯»ã€é«˜å¯ç»´æŠ¤æ€§ã€ä¼ä¸šå‘å¸ƒçº§ä»£ç ã€‚
2.  **æ–‡æ¡£è§„èŒƒ**ï¼šéå¿…è¦ä¸ç”Ÿæˆæ³¨é‡Šä¸æ–‡æ¡£ï¼Œä»£ç è‡ªè§£é‡Šã€‚
3.  **æœ€å°ä½œç”¨åŸŸ**ï¼šå˜æ›´ä»…é™éœ€æ±‚èŒƒå›´ï¼Œ**å¼ºåˆ¶å®¡æŸ¥**å˜æ›´æ˜¯å¦å¼•å…¥å‰¯ä½œç”¨å¹¶åšé’ˆå¯¹æ€§ä¿®æ­£ã€‚

### Phase 5: å®¡è®¡ä¸äº¤ä»˜ (Audit & Delivery)

1.  **è‡ªåŠ¨å®¡è®¡**ï¼šå˜æ›´ç”Ÿæ•ˆåï¼Œ**å¼ºåˆ¶ç«‹å³è°ƒç”¨** Codex ä¸ Gemini åŒæ—¶è¿›è¡Œ Code Reviewï¼Œå¹¶è¿›è¡Œæ•´åˆä¿®å¤ã€‚
    - æ£€æŸ¥é¡¹ï¼šé€»è¾‘æ­£ç¡®æ€§ã€éœ€æ±‚è¦†ç›–ç‡ã€æ½œåœ¨ Bugã€‚
2.  **äº¤ä»˜**ï¼šå®¡è®¡é€šè¿‡ååé¦ˆç»™ç”¨æˆ·ã€‚

## 2. Resource Matrix

æ­¤çŸ©é˜µå®šä¹‰äº†å„é˜¶æ®µçš„**å¼ºåˆ¶æ€§**èµ„æºè°ƒç”¨ç­–ç•¥ã€‚Claude ä½œä¸º**ä¸»æ§æ¨¡å‹ (Orchestrator)**ï¼Œå¿…é¡»ä¸¥æ ¼æ ¹æ®å½“å‰ Workflow é˜¶æ®µï¼ŒæŒ‰ä»¥ä¸‹è§„æ ¼è°ƒåº¦å¤–éƒ¨èµ„æºã€‚

| Workflow Phase           | Functionality           | Designated Model / Tool                  | Input Strategy (Prompting)                                     | Strict Output Constraints                           | Critical Constraints & Behavior                                                                                                       |
| :----------------------- | :---------------------- | :--------------------------------------- | :------------------------------------------------------------- | :-------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------ |
| **Phase 1**              | **Context Retrieval**   | **Auggie** (`mcp__auggie`)               | **Natural Language (English)**<br>Focus on: _What, Where, How_ | **Raw Code / Definitions**<br>(Complete Signatures) | â€¢ **Forbidden:** `grep` / keyword search.<br>â€¢ **Mandatory:** Recursive retrieval until context is complete.                          |
| **Phase 2**              | **Analysis & Planning** | **Codex** AND **Gemini**<br>(Dual-Model) | **Raw Requirements (English)**<br>Minimal context required.    | **Step-by-Step Plan**<br>(Text & Pseudo-code)       | â€¢ **Action:** Cross-validate outputs from both models.<br>â€¢ **Goal:** Eliminate logic gaps before coding starts.                      |
| **Phase 3**<br>(Route A) | **Frontend / UI / UX**  | **Gemini**                               | **English**<br>Context Limit: **< 32k tokens**                 | **Unified Diff Patch**<br>(Prototype Only)          | â€¢ **Truth Source:** The only authority for CSS/React/Vue styles.<br>â€¢ **Warning:** Ignore its backend logic suggestions.              |
| **Phase 3**<br>(Route B) | **Backend / Logic**     | **Codex**                                | **English**<br>Focus on: Logic & Algorithms                    | **Unified Diff Patch**<br>(Prototype Only)          | â€¢ **Capability:** Use for complex debugging & algorithmic implementation.<br>â€¢ **Security:** **NO** file system write access allowed. |
| **Phase 4**              | **Refactoring**         | **Claude (Self)**                        | N/A (Internal Processing)                                      | **Production Code**                                 | â€¢ **Sovereignty:** You are the specific implementer.<br>â€¢ **Style:** Clean, efficient, no redundancy. Minimal comments.               |
| **Phase 5**              | **Audit & QA**          | **Codex** AND **Gemini**<br>(Dual-Model) | **Unified Diff** + **Target File**<br>(English)                | **Review Comments**<br>(Potential Bugs/Edge Cases)  | â€¢ **Mandatory:** Triggered immediately after code changes.<br>â€¢ **Action:** Synthesize feedback into a final fix.                     |

## 3. æŠ€æœ¯è§„èŒƒï¼ˆå¼ºåˆ¶éµå®ˆï¼‰

ç¼–å†™ä»£ç å‰**å¿…é¡»**é˜…è¯»å¹¶éµå®ˆä»¥ä¸‹æŠ€æœ¯è§„èŒƒæ–‡æ¡£ï¼š

| é¢†åŸŸ | è§„èŒƒæ–‡æ¡£ | è§¦å‘æ¡ä»¶ |
|------|----------|----------|
| **åç«¯** | `docs/backend/æŠ€æœ¯è§„èŒƒ.md` | ä¿®æ”¹ `backend/**/*.go` |
| **å‰ç«¯** | `docs/frontend/æŠ€æœ¯è§„èŒƒ.md` | ä¿®æ”¹ `frontend/**/*.vue`, `frontend/**/*.ts` |

### å…³é”®çº¦æŸé€ŸæŸ¥

**åç«¯**ï¼š
- åˆ†å±‚æ¶æ„ï¼š`Handler â†’ Service â†’ Repository â†’ Model`
- æ—¶é—´å¤„ç†ï¼š**å¿…é¡»**ä½¿ç”¨ `dromara/carbon`ï¼Œç¦æ­¢ `time.Now()`
- å“åº”æ ¼å¼ï¼šä½¿ç”¨ `response.Success/Error/Unauthorized`
- æ‰€æœ‰ Handler å¿…é¡»æ·»åŠ  Swagger æ³¨è§£

**å‰ç«¯**ï¼š
- ç»„ä»¶å†™æ³•ï¼šComposition API + `<script setup lang="ts">`
- ç±»å‹å®‰å…¨ï¼šç¦æ­¢ä½¿ç”¨ `any` ç±»å‹
- æ ·å¼ï¼šä½¿ç”¨ TailwindCSSï¼Œç¦æ­¢å†…è” style
- API è°ƒç”¨ï¼šä» `@/api` å¯¼å…¥ï¼Œç¦æ­¢ç›´æ¥ä½¿ç”¨ axios

---

_ğŸ’¡ æç¤º: è¯¦ç»†è§„èŒƒå·²æ‹†åˆ†åˆ° `.claude/rules/` ç›®å½•ï¼ŒæŒ‰æ–‡ä»¶ç±»å‹è‡ªåŠ¨åŠ è½½ã€‚_
